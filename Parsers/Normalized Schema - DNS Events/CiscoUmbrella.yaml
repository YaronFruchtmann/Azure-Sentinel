Parser:
  Title: Cisco Umbrella DNS Events
  Version: '0.0'
  LastUpdated: May 10, 2021
Product:
  Name: Cisco
Normalization:
  Schema: DnsEvents
  Version: '1.0.0'
References:
- Title: Using functions
  Link: https://docs.microsoft.com
- Title: Tech Community
  Link: https://techcommunity.microsoft.com
Description: |
  TODO
ParserName: CiscoUmbrella_DnsEvents_Normalized
ParserQuery: |
  let DNSQuery_CiscoUmbrella=(){
    Cisco_Umbrella_dns_CL
    | project 
		//
		///////// Already Aligned
		TimeGenerated,
        SrcIpAddr=column_ifexists('InternalIp_s', ''),
        UrlCategory=column_ifexists('Categories_s', ''),
        EventType=column_ifexists('EventType_s', ''),
        Query=column_ifexists('Domain_s', ''),   // [DnsQueryName]
        ResponseCodeName=column_ifexists('ResponseCode_s', ''), // [DnsResponseCodeName]
        ////// Should we rename?
        RecordTypeName=column_ifexists('QueryType_s', ''), //[DnsQueryTypeName]
		//
		////// Missing this ? 
        SrcNatIpAddr=column_ifexists('ExternalIp_s', ''),
		DvcAction=column_ifexists('Action_s', ''),
        EventEndTime=column_ifexists('Timestamp_t', ''),  // [is this the same as TimeGenrated?]
		//
		// Extension
        Identities=column_ifexists('Identities_s', ''),
        IdentityTypes=column_ifexists('Identity_Types_s', ''),
        PolicyIdentity=column_ifexists('Policy_Identity_s', ''),
        PolicyIdentityType=column_ifexists('Policy_Identity_Type_s', '')
		// Leave as is 
        ThreatCategory=column_ifexists('Blocked_Categories_s', ''),};	